class Solution:
	def tsp(self, cost):
        from functools import cache
        MAX_COST = 15 * 10**4
        n = len(cost)
        all_visited_mask = (1 << n) - 1
        
        @cache
        def dfs(u=0, visited_mask=1):
            if visited_mask == all_visited_mask:
                # All visited, returning to city "0"
                return cost[u][0]
            min_cost = MAX_COST
            for v in range(1, n):
                v_mask = 1 << v
                if visited_mask & v_mask == 0:
                    v_cost = dfs(v, visited_mask | v_mask) + cost[u][v]
                    if v_cost < min_cost:
                        min_cost = v_cost
            return min_cost
        
        return dfs()
		
